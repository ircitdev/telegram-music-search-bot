# UspMusicFinder Bot - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
4. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
6. [–°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏](#—Å–∏—Å—Ç–µ–º–∞-–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏)
7. [–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã](#–ø–ª–∞—Ç–µ–∂–Ω—ã–µ-—Å–∏—Å—Ç–µ–º—ã)
8. [API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –±–æ—Ç–æ–≤](#api-–¥–ª—è-–≤–Ω–µ—à–Ω–∏—Ö-–±–æ—Ç–æ–≤)
9. [–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å](#–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è-–ø–∞–Ω–µ–ª—å)
10. [–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
11. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
12. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ù–∞–∑–≤–∞–Ω–∏–µ** | UspMusicFinder Bot |
| **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞** | Telegram |
| **Bot Username** | @UspMusicFinder_bot |
| **Bot ID** | 8409655187 |
| **–ö–∞–Ω–∞–ª** | @TopMusicToday |
| **–°–µ—Ä–≤–µ—Ä** | 31.44.7.144 |
| **–ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** | /root/uspmusic-bot |
| **–Ø–∑—ã–∫** | Python 3.11+ |
| **Framework** | aiogram 3.15 |

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

UspMusicFinder Bot - —ç—Ç–æ –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞, —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –º—É–∑—ã–∫–∏. –ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:

- –ò—Å–∫–∞—Ç—å –º—É–∑—ã–∫—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø–µ—Å–Ω–∏ –∏–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
- –°–∫–∞—á–∏–≤–∞—Ç—å —Ç—Ä–µ–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MP3 (192 kbps)
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –º—É–∑—ã–∫—É –ø–æ –∞—É–¥–∏–æ–∑–∞–ø–∏—Å–∏ –∏–ª–∏ –Ω–∞–ø–µ–≤–∞–Ω–∏—é
- –ü–æ–ª—É—á–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç—Ä–µ–∫–∏
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
- –î–µ–ª–∏—Ç—å—Å—è —Ç—Ä–µ–∫–∞–º–∏ —Å –¥—Ä—É–∑—å—è–º–∏

### –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç freemium –º–æ–¥–µ–ª—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏:

| –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –õ–∏–º–∏—Ç—ã | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
|------------------|--------|-------------|
| **Free** | 10 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π/–¥–µ–Ω—å | –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª |
| **Premium** | –ë–µ–∑–ª–∏–º–∏—Ç | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤, x2 –±–æ–Ω—É—Å—ã |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        TELEGRAM API                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         BOT (aiogram)                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Dispatcher ‚îÇ‚îÄ‚îÄ‚îÇ   Routers   ‚îÇ‚îÄ‚îÄ‚îÇ  Middleware (FSM, i18n) ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                   ‚îÇ                    ‚îÇ
         ‚ñº                   ‚ñº                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Handlers   ‚îÇ     ‚îÇ  Services   ‚îÇ      ‚îÇ   Utils     ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ     ‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ      ‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  ‚Ä¢ start    ‚îÇ     ‚îÇ  ‚Ä¢ search   ‚îÇ      ‚îÇ  ‚Ä¢ logger   ‚îÇ
‚îÇ  ‚Ä¢ search   ‚îÇ     ‚îÇ  ‚Ä¢ download ‚îÇ      ‚îÇ  ‚Ä¢ cache    ‚îÇ
‚îÇ  ‚Ä¢ top      ‚îÇ     ‚îÇ  ‚Ä¢ recognize‚îÇ      ‚îÇ  ‚Ä¢ rate_lim ‚îÇ
‚îÇ  ‚Ä¢ premium  ‚îÇ     ‚îÇ  ‚Ä¢ payments ‚îÇ      ‚îÇ  ‚Ä¢ cleanup  ‚îÇ
‚îÇ  ‚Ä¢ admin    ‚îÇ     ‚îÇ             ‚îÇ      ‚îÇ  ‚Ä¢ sentry   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                   ‚îÇ
         ‚ñº                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         DATABASE                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  users  ‚îÇ  ‚îÇ downloads‚îÇ  ‚îÇ favorites ‚îÇ  ‚îÇ  track_stats    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                       ‚îÇ
‚îÇ  ‚îÇpayments ‚îÇ  ‚îÇ referrals‚îÇ  ‚îÇdaily_down ‚îÇ                       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                   ‚îÇ
         ‚ñº                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  External   ‚îÇ     ‚îÇ              EXTERNAL APIS                   ‚îÇ
‚îÇ  Services   ‚îÇ     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ     ‚îÇ  ‚îÇ YouTube  ‚îÇ  ‚îÇ AudD ‚îÇ  ‚îÇ CryptoBot API  ‚îÇ ‚îÇ
‚îÇ  ‚Ä¢ yt-dlp   ‚îÇ     ‚îÇ  ‚îÇ  Music   ‚îÇ  ‚îÇ  API ‚îÇ  ‚îÇ (Payments)     ‚îÇ ‚îÇ
‚îÇ  ‚Ä¢ ffmpeg   ‚îÇ     ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
UspMusicFinder/
‚îú‚îÄ‚îÄ src/                           # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îÇ   ‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models.py                  # Pydantic –º–æ–¥–µ–ª–∏ (Track)
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py               # Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ handlers/                  # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py               # /start, /help, Quick Replies
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.py              # –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –º—É–∑—ã–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ top.py                 # –¢–æ–ø –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history.py             # –ò—Å—Ç–æ—Ä–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ favorites.py           # –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recommendations.py     # –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ referral.py            # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ premium.py             # –ü—Ä–µ–º–∏—É–º –∏ –ø–ª–∞—Ç–µ–∂–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recognize.py           # –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ language.py            # –°–º–µ–Ω–∞ —è–∑—ã–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py               # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.py                 # API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –±–æ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ callbacks.py           # –û–±—Ä–∞–±–æ—Ç–∫–∞ callback –∫–Ω–æ–ø–æ–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ locales/                   # –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py            # –ö–ª–∞—Å—Å Localization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ru.py                  # –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ en.py                  # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ uz.py                  # –£–∑–±–µ–∫—Å–∫–∏–π —è–∑—ã–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/                  # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.py          # SQLite –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories/          # Repository pattern
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ user_repo.py       # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ download_repo.py   # –ò—Å—Ç–æ—Ä–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ favorite_repo.py   # –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ stats_repo.py      # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–∫–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ payments/                  # –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stars.py               # Telegram Stars
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cryptobot.py           # CryptoBot API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ searchers/                 # –ü–æ–∏—Å–∫ –º—É–∑—ã–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ youtube.py             # YouTube Music –ø–æ–∏—Å–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ downloaders/               # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ youtube_dl.py          # yt-dlp –∑–∞–≥—Ä—É–∑—á–∏–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/                  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth_codes.py          # –ö–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤–µ–±-–∞–¥–º–∏–Ω–∫–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/                     # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ logger.py              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ cache.py               # In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ rate_limiter.py        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ cleanup.py             # –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ sentry.py              # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Sentry
‚îÇ       ‚îî‚îÄ‚îÄ channel_poster.py      # –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –≤ –∫–∞–Ω–∞–ª
‚îÇ
‚îú‚îÄ‚îÄ tests/                         # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py                # Pytest fixtures
‚îÇ   ‚îú‚îÄ‚îÄ test_config.py             # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_payments.py           # –¢–µ—Å—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ test_auth_codes.py         # –¢–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_database.py           # –¢–µ—Å—Ç—ã –ë–î
‚îÇ
‚îú‚îÄ‚îÄ scripts/                       # –°–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ backup.sh                  # –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ restore.sh                 # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
‚îÇ
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ ci.yml                 # GitHub Actions CI/CD
‚îÇ
‚îú‚îÄ‚îÄ data/                          # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ temp/                      # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ cache/                     # –ö—ç—à
‚îÇ   ‚îî‚îÄ‚îÄ database.db                # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îú‚îÄ‚îÄ logs/                          # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile                     # Docker –æ–±—Ä–∞–∑ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ Dockerfile.dashboard           # Docker –æ–±—Ä–∞–∑ –≤–µ–±-–∞–¥–º–∏–Ω–∫–∏
‚îú‚îÄ‚îÄ docker-compose.yml             # Docker Compose
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example                   # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ README.md                      # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ TODO.md                        # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ API_instructions.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
```

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ü–æ–∏—Å–∫ –º—É–∑—ã–∫–∏

**–ö–æ–º–∞–Ω–¥–∞:** –õ—é–±–æ–π —Ç–µ–∫—Å—Ç (–Ω–µ –∫–æ–º–∞–Ω–¥–∞)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏ –∏–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
- –ë–æ—Ç –∏—â–µ—Ç —Ç—Ä–µ–∫–∏ —á–µ—Ä–µ–∑ YouTube Music API
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ 20 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (–ø–æ 10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –ò—Å—Ç–æ—á–Ω–∏–∫: YouTube Music (—á–µ—Ä–µ–∑ ytmusicapi)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: 10 –º–∏–Ω—É—Ç
- Rate limiting: 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

**–§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```
üéµ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "Queen"
–ù–∞–π–¥–µ–Ω–æ: 20 —Ç—Ä–µ–∫–æ–≤

ü•á Queen
   üé§ Bohemian Rhapsody
   ‚è±Ô∏è 5:55

ü•à Queen
   üé§ We Will Rock You
   ‚è±Ô∏è 2:02
...
```

### 2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–æ–≤

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —Å –Ω–æ–º–µ—Ä–æ–º —Ç—Ä–µ–∫–∞ (1-10)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ yt-dlp
3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ MP3 (192 kbps)
4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –Ω–∞–∑–≤–∞–Ω–∏–µ)
5. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
6. –ó–∞–ø–∏—Å—å –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 50 MB (–ª–∏–º–∏—Ç Telegram)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 60 –º–∏–Ω—É—Ç
- –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –¥–ª—è Free: 10 —Ç—Ä–µ–∫–æ–≤

### 3. –¢–æ–ø —Ç—Ä–µ–∫–æ–≤

**–ö–æ–º–∞–Ω–¥–∞:** `/top` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üèÜ –¢–æ–ø —Ç—Ä–µ–∫–æ–≤"

**–ü–µ—Ä–∏–æ–¥—ã:**
- üìÖ –°–µ–≥–æ–¥–Ω—è
- üìÜ –ù–µ–¥–µ–ª—è
- üìä –ú–µ—Å—è—Ü
- üèÜ –í—Å–µ –≤—Ä–µ–º—è

**–§–æ—Ä–º–∞—Ç:**
```
üèÜ –¢–û–ü-10 –ó–ê –ù–ï–î–ï–õ–Æ

ü•á Artist - Title
    ‚¨áÔ∏è 150 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π

ü•à Artist - Title
    ‚¨áÔ∏è 120 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
...
```

### 4. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ö–æ–º–∞–Ω–¥–∞:** `/recommendations` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üéµ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ø-3 –ª—é–±–∏–º—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
3. –ü–æ–∏—Å–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤ —ç—Ç–∏—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–∂–µ —Å–∫–∞—á–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤
5. –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —Ç—Ä–µ–∫–∞–º–∏

### 5. –ò—Å—Ç–æ—Ä–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏–π

**–ö–æ–º–∞–Ω–¥–∞:** `/history` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üìú –ò—Å—Ç–æ—Ä–∏—è"

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–∞—Ç–∞
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π

### 6. –ò–∑–±—Ä–∞–Ω–Ω–æ–µ

**–ö–æ–º–∞–Ω–¥–∞:** `/favorites` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ"

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–∫–∞ –∫–Ω–æ–ø–∫–æ–π ‚ù§Ô∏è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ —Å–ø–∏—Å–∫–∞

### 7. –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏

**–ö–æ–º–∞–Ω–¥–∞:** `/recognize`

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**
- –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã
- –í–∏–¥–µ–æ—Å–æ–æ–±—â–µ–Ω–∏—è (–∫—Ä—É–∂–∫–∏)
- –ù–∞–ø–µ–≤–∞–Ω–∏–µ (humming)

**API:** AudD (audd.io)

**–õ–∏–º–∏—Ç—ã:**
- Free: 5 —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–π –≤ –¥–µ–Ω—å
- Premium: –±–µ–∑–ª–∏–º–∏—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üéµ –ù–∞–π–¥–µ–Ω–∞ –ø–µ—Å–Ω—è!

üé§ Queen
üéµ Bohemian Rhapsody
üíø A Night at the Opera

[–°–∫–∞—á–∞—Ç—å —ç—Ç–æ—Ç —Ç—Ä–µ–∫]
```

### 8. –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

**–ö–æ–º–∞–Ω–¥–∞:** `/referral` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "üë• –†–µ—Ñ–µ—Ä–∞–ª—ã"

**–ù–∞–≥—Ä–∞–¥—ã:**
- +5 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–≥–æ
- +10 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –∫–æ–≥–¥–∞ —Ä–µ—Ñ–µ—Ä–∞–ª —Å–∫–∞—á–∞–µ—Ç 5 —Ç—Ä–µ–∫–æ–≤

**–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–∫–∏:** `https://t.me/UspMusicFinder_bot?start=ref_USER_ID`

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã

### 9. –ü—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∞

**–ö–æ–º–∞–Ω–¥–∞:** `/premium` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "‚≠ê –ü—Ä–µ–º–∏—É–º"

**–¢–∞—Ä–∏—Ñ—ã (Telegram Stars):**
| –ü–ª–∞–Ω | –¶–µ–Ω–∞ | –°—Ä–æ–∫ |
|------|------|------|
| –ú–µ—Å—è—Ü | 50 ‚≠ê | 30 –¥–Ω–µ–π |
| –ö–≤–∞—Ä—Ç–∞–ª | 120 ‚≠ê | 90 –¥–Ω–µ–π |
| –ì–æ–¥ | 360 ‚≠ê | 365 –¥–Ω–µ–π |

**–¢–∞—Ä–∏—Ñ—ã (CryptoBot):**
| –ü–ª–∞–Ω | –¶–µ–Ω–∞ | –°—Ä–æ–∫ |
|------|------|------|
| –ú–µ—Å—è—Ü | $2.99 USDT | 30 –¥–Ω–µ–π |
| –ö–≤–∞—Ä—Ç–∞–ª | $6.99 USDT | 90 –¥–Ω–µ–π |
| –ì–æ–¥ | $19.99 USDT | 365 –¥–Ω–µ–π |

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Premium:**
- ‚ôæ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
- üéµ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤
- ‚ù§Ô∏è –ë–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- üéÅ x2 –±–æ–Ω—É—Å—ã –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤

### 10. –°–º–µ–Ω–∞ —è–∑—ã–∫–∞

**–ö–æ–º–∞–Ω–¥–∞:** `/lang`

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏:**
- üá∑üá∫ –†—É—Å—Å–∫–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- üá¨üáß English
- üá∫üáø O'zbek

### 11. –ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ (/get)

**–ö–æ–º–∞–Ω–¥–∞:** `/get –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç—Ä–µ–∫–∞ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞.
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –±–æ—Ç–∞–º–∏ (Mira Bot –∏ –¥—Ä.)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/get Coldplay Yellow
/get Queen Bohemian Rhapsody
/get –ö–∏–Ω–æ –ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏
```

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç –ø–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–∫ –∏ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç –µ–≥–æ.

### 12. –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç—Ä–µ–∫–æ–º

**–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–∫–∏:** `https://t.me/UspMusicFinder_bot?start=track_VIDEO_ID`

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–µ–∫.

### 13. Deep Link –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–∫–∏:** `https://t.me/UspMusicFinder_bot?start=–Ω–∞–∑–≤–∞–Ω–∏–µ_–ø–µ—Å–Ω–∏`

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø–µ—Å–Ω–∏ (–¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ò—â–µ—Ç —Ç—Ä–µ–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
3. –°–∫–∞—á–∏–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –±–æ—Ç–∞–º–∏.

### 14. Quick Replies –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞

–ü–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/start` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üèÜ –¢–æ–ø —Ç—Ä–µ–∫–æ–≤   ‚îÇ üéµ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìú –ò—Å—Ç–æ—Ä–∏—è      ‚îÇ ‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚≠ê –ü—Ä–µ–º–∏—É–º      ‚îÇ üë• –†–µ—Ñ–µ—Ä–∞–ª—ã     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------|------------|
| Python | 3.11+ | –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è |
| aiogram | 3.15 | Telegram Bot Framework |
| aiosqlite | 0.19+ | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π SQLite |
| yt-dlp | Latest | –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞ |
| mutagen | 1.47+ | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞—É–¥–∏–æ |
| aiohttp | 3.9+ | HTTP –∫–ª–∏–µ–Ω—Ç |
| pydantic | 2.0+ | –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö |
| python-dotenv | 1.0+ | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |

### –í–Ω–µ—à–Ω–∏–µ API

| API | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
|-----|------------|--------------|
| YouTube Music | –ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–æ–≤ | ytmusicapi |
| AudD | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏ | audd.io |
| CryptoBot | –ö—Ä–∏–ø—Ç–æ–ø–ª–∞—Ç–µ–∂–∏ | t.me/CryptoBot |
| Telegram Stars | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ | Telegram API |
| Sentry | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ | sentry.io |

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|------------|
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker | –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è | Docker Compose | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ |
| CI/CD | GitHub Actions | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | Sentry | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | pytest | Unit —Ç–µ—Å—Ç—ã |
| –õ–∏–Ω—Ç–∏–Ω–≥ | flake8, black | –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ |

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)

```
aiogram>=3.15.0
aiosqlite>=0.19.0
aiohttp>=3.9.0
yt-dlp>=2024.1.0
mutagen>=1.47.0
pydantic>=2.0.0
python-dotenv>=1.0.0
aiocryptopay>=0.4.0
sentry-sdk>=1.39.0
ytmusicapi>=1.3.0
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–°–£–ë–î:** SQLite
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞:** aiosqlite (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è)
- **–ü—É—Ç—å:** `./data/database.db`
- **Pattern:** Repository

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞: users

–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö.

```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,              -- Telegram user ID
    username TEXT,                        -- @username
    first_name TEXT,                      -- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    language TEXT DEFAULT 'ru',           -- –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    is_premium INTEGER DEFAULT 0,         -- –ü—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å
    premium_until TIMESTAMP,              -- –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–µ–º–∏—É–º–∞
    referral_code TEXT UNIQUE,            -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
    referred_by INTEGER,                  -- ID –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    bonus_downloads INTEGER DEFAULT 0,    -- –ë–æ–Ω—É—Å–Ω—ã–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
    searches INTEGER DEFAULT 0,           -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–æ–≤
    downloads INTEGER DEFAULT 0,          -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
    recognize_count INTEGER DEFAULT 0,    -- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è
    last_recognize_date TEXT,             -- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_seen TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### –¢–∞–±–ª–∏—Ü–∞: downloads

–ò—Å—Ç–æ—Ä–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```sql
CREATE TABLE downloads (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,             -- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    track_id TEXT NOT NULL,               -- YouTube video ID
    title TEXT NOT NULL,                  -- –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞
    artist TEXT,                          -- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
    duration INTEGER,                     -- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    downloaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: favorites

–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```sql
CREATE TABLE favorites (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    track_id TEXT NOT NULL,
    title TEXT NOT NULL,
    artist TEXT,
    duration INTEGER,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE(user_id, track_id)             -- –û–¥–∏–Ω —Ç—Ä–µ–∫ - –æ–¥–∏–Ω —Ä–∞–∑
);
```

#### –¢–∞–±–ª–∏—Ü–∞: track_stats

–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–∫–æ–≤ –¥–ª—è —Ç–æ–ø–∞.

```sql
CREATE TABLE track_stats (
    track_id TEXT PRIMARY KEY,            -- YouTube video ID
    title TEXT NOT NULL,
    artist TEXT,
    duration INTEGER,
    download_count INTEGER DEFAULT 0,     -- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
    last_downloaded TIMESTAMP
);
```

#### –¢–∞–±–ª–∏—Ü–∞: daily_downloads

–î–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã —Å–∫–∞—á–∏–≤–∞–Ω–∏–π.

```sql
CREATE TABLE daily_downloads (
    user_id INTEGER NOT NULL,
    download_date DATE NOT NULL,
    count INTEGER DEFAULT 1,
    UNIQUE(user_id, download_date)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: payments

–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π.

```sql
CREATE TABLE payments (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    amount REAL NOT NULL,                 -- –°—É–º–º–∞
    currency TEXT DEFAULT 'XTR',          -- –í–∞–ª—é—Ç–∞ (XTR = Stars)
    payment_type TEXT,                    -- premium/donate
    payment_system TEXT,                  -- stars/cryptobot
    status TEXT DEFAULT 'pending',
    external_id TEXT,                     -- ID –≤–æ –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–µ
    payload TEXT,                         -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### –¢–∞–±–ª–∏—Ü–∞: referrals

–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö.

```sql
CREATE TABLE referrals (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    referrer_id INTEGER NOT NULL,         -- –ü—Ä–∏–≥–ª–∞—Å–∏–≤—à–∏–π
    referred_id INTEGER NOT NULL,         -- –ü—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–π
    is_active INTEGER DEFAULT 0,          -- –ê–∫—Ç–∏–≤–µ–Ω (—Å–∫–∞—á–∞–ª 5+ —Ç—Ä–µ–∫–æ–≤)
    first_download_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (referrer_id) REFERENCES users(id),
    FOREIGN KEY (referred_id) REFERENCES users(id),
    UNIQUE(referrer_id, referred_id)
);
```

### –ò–Ω–¥–µ–∫—Å—ã

```sql
CREATE INDEX idx_downloads_user_id ON downloads(user_id);
CREATE INDEX idx_downloads_date ON downloads(downloaded_at);
CREATE INDEX idx_favorites_user_id ON favorites(user_id);
CREATE INDEX idx_daily_downloads_user_date ON daily_downloads(user_id, download_date);
CREATE INDEX idx_track_stats_count ON track_stats(download_count DESC);
CREATE INDEX idx_users_referral ON users(referral_code);
CREATE INDEX idx_referrals_referrer ON referrals(referrer_id);
CREATE INDEX idx_referrals_referred ON referrals(referred_id);
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤ `connection.py`:

```python
async def _run_migrations(self):
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
    migrations = [
        "ALTER TABLE users ADD COLUMN recognize_count INTEGER DEFAULT 0",
        "ALTER TABLE users ADD COLUMN last_recognize_date TEXT",
        "ALTER TABLE users ADD COLUMN language TEXT DEFAULT 'ru'",
        "ALTER TABLE payments ADD COLUMN payload TEXT",
    ]
    for migration in migrations:
        try:
            await self.connection.execute(migration)
            await self.connection.commit()
        except Exception:
            pass  # –ö–æ–ª–æ–Ω–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

---

## –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```python
# src/locales/__init__.py

class Localization:
    _translations: Dict[str, Dict[str, str]] = {}
    _user_languages: Dict[int, str] = {}

    @classmethod
    def get(cls, key: str, user_id: int, **kwargs) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ."""
        lang = cls.get_user_lang(user_id)
        message = cls._translations[lang].get(key)
        if kwargs:
            message = message.format(**kwargs)
        return message
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏

| –ö–æ–¥ | –Ø–∑—ã–∫ | –§–∞–π–ª |
|-----|------|------|
| ru | –†—É—Å—Å–∫–∏–π | locales/ru.py |
| en | English | locales/en.py |
| uz | O'zbek | locales/uz.py |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

```python
# src/locales/ru.py

MESSAGES = {
    # –û–±—â–∏–µ
    "welcome": "üéµ <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ UspMusicFinder Bot!</b>...",
    "help": "üéµ <b>UspMusicFinder Bot - Help</b>...",

    # –ö–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    "btn_top": "üèÜ –¢–æ–ø —Ç—Ä–µ–∫–æ–≤",
    "btn_recommendations": "üéµ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
    "btn_history": "üìú –ò—Å—Ç–æ—Ä–∏—è",
    "btn_favorites": "‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ",
    "btn_premium": "‚≠ê –ü—Ä–µ–º–∏—É–º",
    "btn_referral": "üë• –†–µ—Ñ–µ—Ä–∞–ª—ã",

    # –ü–æ–∏—Å–∫
    "search_results": "üéµ <b>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</b> <code>{query}</code>...",
    "search_no_results": "‚ùå <b>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</b>...",

    # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
    "downloading": "‚è≥ <b>–ó–∞–≥—Ä—É–∑–∫–∞...</b>\n\nüéµ {title}\nüë§ {artist}",
    "download_success": "‚úÖ –ì–æ—Ç–æ–≤–æ!",
    "download_error": "‚ùå <b>–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏</b>...",

    # –ò –¥—Ä—É–≥–∏–µ –∫–ª—é—á–∏...
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```python
from src.locales import _

# –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
message = _("welcome", user_id=12345)

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
message = _("downloading", user_id=12345, title="Song", artist="Artist")
```

---

## –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

### 1. Telegram Stars

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∞–ª—é—Ç–∞ Telegram –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π –≤–Ω—É—Ç—Ä–∏ –±–æ—Ç–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `src/payments/stars.py`

```python
class StarsPayment:
    TARIFFS = {
        "month": {"stars": 50, "days": 30, "title": "1 –º–µ—Å—è—Ü"},
        "quarter": {"stars": 120, "days": 90, "title": "3 –º–µ—Å—è—Ü–∞"},
        "year": {"stars": 360, "days": 365, "title": "1 –≥–æ–¥"},
    }

    DONATIONS = {
        "coffee": {"stars": 10, "title": "‚òï –ö–æ—Ñ–µ"},
        "pizza": {"stars": 50, "title": "üçï –ü–∏—Ü—Ü–∞"},
        "dinner": {"stars": 100, "title": "üçΩ –£–∂–∏–Ω"},
    }
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ
2. –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç Invoice —á–µ—Ä–µ–∑ `bot.send_invoice()`
3. Telegram –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
4. `pre_checkout_query` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
5. `successful_payment` - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–µ–º–∏—É–º–∞

### 2. CryptoBot

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ @CryptoBot.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã:** USDT, TON, BTC, ETH

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `src/payments/cryptobot.py`

```python
class CryptoBotPayment:
    TARIFFS = {
        "month": {"amount": 2.99, "days": 30},
        "quarter": {"amount": 6.99, "days": 90},
        "year": {"amount": 19.99, "days": 365},
    }
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ
2. –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç Invoice —á–µ—Ä–µ–∑ CryptoBot API
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã
4. Webhook —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
5. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–µ–º–∏—É–º–∞

---

## API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –±–æ—Ç–æ–≤

### –û–ø–∏—Å–∞–Ω–∏–µ

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –±–æ—Ç–∞–º–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–∞—Ç—å –∏ —Å–∫–∞—á–∏–≤–∞—Ç—å –º—É–∑—ã–∫—É —á–µ—Ä–µ–∑ UspMusicFinder.

### –ö–æ–º–∞–Ω–¥—ã API

#### /api - –ü–æ–∏—Å–∫ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞

```
/api <query> <chat_id>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `chat_id` - ID —á–∞—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–µ–∫–∞

**–ü—Ä–∏–º–µ—Ä:**
```
/api Bohemian Rhapsody -1001234567890
```

#### /api_search - –¢–æ–ª—å–∫–æ –ø–æ–∏—Å–∫

```
/api_search <query>
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤ —Å video ID

#### /api_download - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–æ ID

```
/api_download <video_id> <chat_id>
```

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–ª—é—á –≤ `.env`:

```env
API_KEYS=key1,key2,key3
```

–ö–ª—é—á –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –∫–æ–º–∞–Ω–¥—ã:

```
/api KEY123 Bohemian Rhapsody -1001234567890
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Rate limit: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –¢–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

### –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/admin` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ |
| `/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ |
| `/users` | –¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `/setpremium <user_id> <days>` | –í—ã–¥–∞—Ç—å –ø—Ä–µ–º–∏—É–º |
| `/mailing <text>` | –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ |
| `/post_top` | –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–æ–ø –≤ –∫–∞–Ω–∞–ª |

### /admin - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

```
üìä –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨

üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 1,234
üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–π: 45,678
üîç –ü–æ–∏—Å–∫–æ–≤: 123,456
üíé –ü—Ä–µ–º–∏—É–º: 56 –∞–∫—Ç–∏–≤–Ω—ã—Ö

–ü–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞:
‚Ä¢ –ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 23
‚Ä¢ –°–∫–∞—á–∏–≤–∞–Ω–∏–π: 456
‚Ä¢ –ü–ª–∞—Ç–µ–∂–µ–π: $125
```

### /stats - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê

–ó–∞ —Å–µ–≥–æ–¥–Ω—è:
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã—Ö: 234
‚Ä¢ –ù–æ–≤—ã—Ö: 12
‚Ä¢ –°–∫–∞—á–∏–≤–∞–Ω–∏–π: 567

–ó–∞ –Ω–µ–¥–µ–ª—é:
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã—Ö: 890
‚Ä¢ –ù–æ–≤—ã—Ö: 78
‚Ä¢ –°–∫–∞—á–∏–≤–∞–Ω–∏–π: 3,456

–¢–æ–ø —Ç—Ä–µ–∫–æ–≤ —Å–µ–≥–æ–¥–Ω—è:
1. Artist - Title (45 downloads)
2. Artist - Title (38 downloads)
...
```

### /mailing - –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞

```
/mailing –ü—Ä–∏–≤–µ—Ç! –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞!
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (–∏–∑–±–µ–∂–∞–Ω–∏–µ rate limit)
- –ü–æ–¥—Å—á—ë—Ç —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥ –≤ –∫–∞–Ω–∞–ª

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ .env:**
```env
CHANNEL_ID=@TopMusicToday
CHANNEL_POST_HOUR=12
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ç–æ–ø-10 —Ç—Ä–µ–∫–æ–≤ –≤ 12:00
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ milestone —Ç—Ä–µ–∫–∞—Ö (100, 500, 1000 —Å–∫–∞—á–∏–≤–∞–Ω–∏–π)

---

## –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### Docker

#### Dockerfile (–±–æ—Ç)

```dockerfile
FROM python:3.11-slim

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ffmpeg –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ
RUN apt-get update && apt-get install -y ffmpeg

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY src/ ./src/
COPY .env .

# –°–æ–∑–¥–∞–Ω–∏–µ non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
RUN useradd -m botuser
USER botuser

CMD ["python", "-m", "src.main"]
```

#### docker-compose.yml

```yaml
version: '3.8'

services:
  bot:
    build: .
    container_name: uspmusic-bot
    restart: unless-stopped
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    environment:
      - TZ=Europe/Moscow

  dashboard:
    build:
      context: .
      dockerfile: Dockerfile.dashboard
    container_name: uspmusic-dashboard
    ports:
      - "8080:8080"
    volumes:
      - ./data:/app/data

  redis:
    image: redis:alpine
    container_name: uspmusic-redis
    volumes:
      - redis_data:/data

  backup:
    image: alpine
    container_name: uspmusic-backup
    volumes:
      - ./data:/data
      - ./backups:/backups
    command: >
      sh -c "while true; do
        cp /data/database.db /backups/backup_$$(date +%Y%m%d_%H%M%S).db;
        find /backups -mtime +7 -delete;
        sleep 86400;
      done"

volumes:
  redis_data:
```

### GitHub Actions CI/CD

```yaml
# .github/workflows/ci.yml

name: CI/CD

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - run: pip install flake8 black
      - run: flake8 src tests
      - run: black --check src tests

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt pytest pytest-asyncio
      - run: pytest tests/ -v

  build:
    needs: [lint, test]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: docker/build-push-action@v5
        with:
          context: .
          push: false
          tags: uspmusic-bot:latest

  deploy:
    needs: build
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to server
        uses: appleboy/ssh-action@v1
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: root
          key: ${{ secrets.SSH_KEY }}
          script: |
            cd /root/uspmusic-bot
            git pull
            docker-compose up -d --build
```

### –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

#### backup.sh

```bash
#!/bin/bash
BACKUP_DIR="/root/backups"
DB_PATH="/root/uspmusic-bot/data/database.db"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR
cp $DB_PATH $BACKUP_DIR/backup_$DATE.db
gzip $BACKUP_DIR/backup_$DATE.db

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (>7 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.gz" -mtime +7 -delete

echo "Backup created: backup_$DATE.db.gz"
```

#### restore.sh

```bash
#!/bin/bash
BACKUP_FILE=$1
DB_PATH="/root/uspmusic-bot/data/database.db"

if [ -z "$BACKUP_FILE" ]; then
    echo "Usage: ./restore.sh backup_file.db.gz"
    exit 1
fi

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
docker-compose stop bot

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
gunzip -c $BACKUP_FILE > $DB_PATH

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
docker-compose start bot

echo "Database restored from $BACKUP_FILE"
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

| –ú–µ—Ä–∞ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|------|------------|
| –¢–æ–∫–µ–Ω—ã –≤ .env | –ù–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–¥–µ |
| Rate Limiting | 5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö user inputs |
| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ | Max 50MB, 60 –º–∏–Ω |
| Non-root –≤ Docker | –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |
| HTTPS | Telegram API –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç |

### Rate Limiting

```python
# src/utils/rate_limiter.py

class RateLimiter:
    def __init__(self, max_requests: int = 5, period: int = 60):
        self.max_requests = max_requests
        self.period = period
        self._requests: Dict[int, List[float]] = {}

    def is_allowed(self, user_id: int) -> Tuple[bool, int]:
        now = time.time()
        user_requests = self._requests.get(user_id, [])

        # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        user_requests = [t for t in user_requests if now - t < self.period]

        if len(user_requests) >= self.max_requests:
            wait_time = int(self.period - (now - user_requests[0]))
            return False, wait_time

        user_requests.append(now)
        self._requests[user_id] = user_requests
        return True, 0
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# src/utils/logger.py

import logging
from logging.handlers import RotatingFileHandler

def setup_logger():
    logger = logging.getLogger("usp_music_finder")
    logger.setLevel(logging.INFO)

    # –§–∞–π–ª–æ–≤—ã–π handler —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
    file_handler = RotatingFileHandler(
        "logs/bot.log",
        maxBytes=10*1024*1024,  # 10MB
        backupCount=5
    )

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    formatter = logging.Formatter(
        "%(asctime)s | %(levelname)s | %(name)s | %(message)s"
    )
    file_handler.setFormatter(formatter)

    logger.addHandler(file_handler)
    return logger
```

### Sentry –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```python
# src/utils/sentry.py

import sentry_sdk
from src.config import settings

def init_sentry():
    if settings.SENTRY_DSN:
        sentry_sdk.init(
            dsn=settings.SENTRY_DSN,
            traces_sample_rate=0.1,
            environment="production"
        )

def capture_exception(error: Exception):
    sentry_sdk.capture_exception(error)
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
# ===== TELEGRAM =====
BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
BOT_USERNAME=UspMusicFinder_bot

# ===== –ü–£–¢–ò =====
TEMP_DIR=./data/temp
CACHE_DIR=./data/cache
LOGS_DIR=./logs
DATABASE_PATH=./data/database.db

# ===== –õ–ò–ú–ò–¢–´ =====
MAX_FILE_SIZE=52428800          # 50MB (Telegram limit)
MAX_DURATION=600                # 10 –º–∏–Ω—É—Ç
RATE_LIMIT_REQUESTS=5           # –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø–µ—Ä–∏–æ–¥
RATE_LIMIT_PERIOD=60            # –ü–µ—Ä–∏–æ–¥ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

# ===== –õ–û–ì–ò–†–û–í–ê–ù–ò–ï =====
LOG_LEVEL=INFO                  # DEBUG, INFO, WARNING, ERROR

# ===== –§–£–ù–ö–¶–ò–ò =====
ENABLE_CACHE=true
ENABLE_STATS=true
ENABLE_INLINE=true

# ===== –í–ù–ï–®–ù–ò–ï API =====
LASTFM_API_KEY=                 # Last.fm (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
AUDD_API_KEY=abc123...          # AudD –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

# ===== –ü–õ–ê–¢–ï–ñ–ò =====
CRYPTOBOT_TOKEN=xyz789...       # CryptoBot API token

# ===== –ú–û–ù–ò–¢–û–†–ò–ù–ì =====
SENTRY_DSN=https://...@sentry.io/123

# ===== –ö–ê–ù–ê–õ =====
CHANNEL_ID=@TopMusicToday       # –î–ª—è –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞
CHANNEL_POST_HOUR=12            # –ß–∞—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (0-23)

# ===== –ê–î–ú–ò–ù–´ =====
ADMIN_IDS=123456789,987654321   # Telegram user IDs
```

### –ö–ª–∞—Å—Å Settings

```python
# src/config.py

from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    # Telegram
    BOT_TOKEN: str
    BOT_USERNAME: str = "UspMusicFinder_bot"

    # Paths
    TEMP_DIR: str = "./data/temp"
    CACHE_DIR: str = "./data/cache"
    LOGS_DIR: str = "./logs"
    DATABASE_PATH: str = "./data/database.db"

    # Limits
    MAX_FILE_SIZE: int = 52428800
    MAX_DURATION: int = 600
    RATE_LIMIT_REQUESTS: int = 5
    RATE_LIMIT_PERIOD: int = 60

    # Features
    ENABLE_CACHE: bool = True
    ENABLE_STATS: bool = True

    # External APIs
    AUDD_API_KEY: str = ""
    CRYPTOBOT_TOKEN: str = ""
    SENTRY_DSN: str = ""

    # Channel
    CHANNEL_ID: str = ""
    CHANNEL_POST_HOUR: int = 12

    class Config:
        env_file = ".env"

settings = Settings()
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

UspMusicFinder Bot - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º—É–∑—ã–∫–æ–π, –≤–∫–ª—é—á–∞—é—â–∏–π:

- **12+ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (3 —è–∑—ã–∫–∞)
- **–î–≤–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã** (Stars + Crypto)
- **–ü–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É** (Docker, CI/CD, —Ç–µ—Å—Ç—ã)
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é.

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞:** –î–µ–∫–∞–±—Ä—å 2025

**–í–µ—Ä—Å–∏—è:** 1.1.0

**–ê–≤—Ç–æ—Ä:** UspMusicFinder Team
